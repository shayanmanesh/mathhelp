/* Math Help Optimized Script Bundle - v1.0 */
!function(){"use strict";const e={current:"",expression:"",history:[],maxHistory:10,allowedChars:/[0-9+\-*/().\s]/,maxLength:50},t=document.getElementById("display"),n=document.getElementById("history");function r(n){e.current.length<e.maxLength&&e.allowedChars.test(n)&&(e.current+=n,i())}function i(){t&&(t.value=e.current||"0")}function o(){e.current="",e.expression="",i()}function a(){if(!e.current)return;try{const t=Function('"use strict"; return ('+e.current+")")();if(!isFinite(t))throw new Error("Invalid result");e.expression=e.current,e.current=String(t),e.history.unshift({expression:e.expression,result:e.current}),e.history.length>e.maxHistory&&e.history.pop(),l(),i(),"undefined"!=typeof gtag&&gtag("event","calculation",{event_category:"Calculator",event_label:"Basic",value:1})}catch(t){e.current="Error",i(),setTimeout(o,1500)}}function l(){if(!n)return;const t=e.history.slice(0,5).map(e=>`<div class="history-item">${e.expression} = ${e.result}</div>`).join("");n.innerHTML=t||'<div class="history-empty">No calculations yet</div>'}function c(){e.current.length>0&&(e.current=e.current.slice(0,-1),i())}document.addEventListener("DOMContentLoaded",function(){i(),l();const e=document.querySelectorAll(".calc-btn");e.forEach(e=>{e.addEventListener("click",function(){const t=this.textContent,n=this.dataset.action;switch(n){case"number":case"operator":r(t);break;case"clear":o();break;case"equals":a();break;case"backspace":c()}})});let n=document.querySelector(".calculator-widget");if(n){let e={startY:0,currentY:0,isDragging:!1};n.addEventListener("touchstart",t=>{e.startY=t.touches[0].clientY,e.isDragging=!0},{passive:!0}),n.addEventListener("touchmove",t=>{if(!e.isDragging)return;e.currentY=t.touches[0].clientY;const r=e.currentY-e.startY;Math.abs(r)>10&&(n.style.transform=`translateY(${r}px)`)},{passive:!0}),n.addEventListener("touchend",()=>{e.isDragging=!1;const t=e.currentY-e.startY;Math.abs(t)>100?n.style.display="none":n.style.transform="translateY(0)"})}const s=document.querySelector(".mobile-menu-toggle"),u=document.getElementById("navList");s&&u&&(s.addEventListener("click",function(){u.classList.toggle("active"),this.setAttribute("aria-expanded",u.classList.contains("active"))}),u.addEventListener("click",function(e){"A"===e.target.tagName&&(u.classList.remove("active"),s.setAttribute("aria-expanded","false"))}))});class s{constructor(){this.config={ezoicEnabled:!0,adVariants:{},viewabilityThreshold:.5,viewabilityDuration:1e3},this.viewableAds=new Map,this.init()}init(){this.setupLazyLoading(),this.setupViewabilityTracking(),this.setupUserIdTracking(),this.initializeEzoic()}setupLazyLoading(){if("IntersectionObserver"in window){const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;this.loadAd(n),t.unobserve(n)}})},{rootMargin:"50px"});document.querySelectorAll(".ad-container").forEach(t=>{e.observe(t)})}}setupViewabilityTracking(){if("IntersectionObserver"in window){const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.id||"unknown";e.isIntersecting?(this.viewableAds.has(t)||this.viewableAds.set(t,Date.now()),setTimeout(()=>{this.viewableAds.has(t)&&Date.now()-this.viewableAds.get(t)>=this.config.viewabilityDuration&&this.trackAdViewability(t)},this.config.viewabilityDuration)):this.viewableAds.delete(t)})},{threshold:[0,.5,1]});document.querySelectorAll(".ad-container").forEach(t=>{e.observe(t)})}}setupUserIdTracking(){let e=localStorage.getItem("mathhelp_uid");e||(e=this.generateUserId(),localStorage.setItem("mathhelp_uid",e)),this.userId=e}generateUserId(){return"mh_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}loadAd(e){if(e.classList.contains("loaded"))return;const t=e.querySelector("ins.adsbygoogle");t&&!t.dataset.adsbygoogleStatus&&(e.classList.add("loading"),window.adsbygoogle=window.adsbygoogle||[],window.adsbygoogle.push({}),e.classList.remove("loading"),e.classList.add("loaded"))}trackAdViewability(e){this.sendAnalytics("ad_viewable",{ad_position:e,duration:Date.now()-this.viewableAds.get(e)})}initializeEzoic(){this.config.ezoicEnabled&&window.ezstandalone&&window.ezstandalone.cmd&&window.ezstandalone.cmd.push(()=>{})}sendAnalytics(e,t){"undefined"!=typeof gtag&&gtag("event",e,{event_category:"Advertising",event_label:t.ad_position||"unknown",value:t.duration||1,custom_parameters:t})}}setTimeout(()=>{new s},1e3)}();