<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Derivative Calculator - Step by Step Differentiation | Math.help</title>
    <meta name="description" content="Calculate derivatives with step-by-step solutions. Differentiate polynomials, trig functions, exponentials, and more using power rule, chain rule, and product rule.">
    <meta name="keywords" content="derivative calculator step by step, how to find derivatives, calculus differentiation rules, power rule calculator, chain rule examples, product rule solver, quotient rule calculator, derivative of polynomial functions, trigonometric derivatives, logarithmic differentiation, implicit differentiation calculator, free derivative solver online">
    <meta name="robots" content="index, follow">
    
    <link rel="stylesheet" href="../../styles.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
    
    <!-- Ezoic Integration Scripts -->
    <script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
    <script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>
    <script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
    <script>
        window.ezstandalone = window.ezstandalone || {};
        ezstandalone.cmd = ezstandalone.cmd || [];
    </script>
    
    <!-- KaTeX JavaScript -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    <script defer src="../../katex-lazy.js"></script>
    
    <!-- Enhanced Educational Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "WebPage",
                "@id": "https://math.help/calculus/derivative-calculator/",
                "name": "Derivative Calculator - Step by Step Differentiation Solutions",
                "description": "Free online derivative calculator with detailed step-by-step solutions. Learn calculus differentiation using power rule, chain rule, product rule, and quotient rule.",
                "url": "https://math.help/calculus/derivative-calculator/",
                "inLanguage": "en-US",
                "isPartOf": {
                    "@id": "https://math.help/#website"
                },
                "about": {
                    "@type": "Thing",
                    "name": "Derivatives and Differentiation",
                    "description": "The process of finding the rate of change of a function"
                },
                "educationalLevel": ["High School", "College", "University"],
                "learningResourceType": ["Interactive Tool", "Calculator", "Tutorial"],
                "mainEntity": {
                    "@id": "https://math.help/calculus/derivative-calculator/#calculator"
                }
            },
            {
                "@type": "SoftwareApplication",
                "@id": "https://math.help/calculus/derivative-calculator/#calculator",
                "name": "Derivative Calculator with Steps",
                "description": "Advanced calculus calculator for computing derivatives with complete step-by-step explanations",
                "applicationCategory": "EducationalApplication",
                "operatingSystem": "Web Browser",
                "offers": {
                    "@type": "Offer",
                    "price": "0",
                    "priceCurrency": "USD"
                },
                "featureList": [
                    "Power rule differentiation",
                    "Chain rule application",
                    "Product rule calculation", 
                    "Quotient rule solving",
                    "Trigonometric derivatives",
                    "Exponential and logarithmic derivatives",
                    "Step-by-step explanations"
                ]
            },
            {
                "@type": "LearningResource",
                "@id": "https://math.help/calculus/derivative-calculator/#tutorial",
                "name": "How to Calculate Derivatives",
                "description": "Complete guide to differentiation rules and techniques in calculus",
                "educationalLevel": "College",
                "learningResourceType": "Tutorial",
                "teaches": [
                    "Power rule",
                    "Chain rule",
                    "Product rule",
                    "Quotient rule",
                    "Derivative applications"
                ],
                "timeRequired": "PT45M",
                "educationalUse": "instruction"
            },
            {
                "@type": "MathSolver",
                "name": "Derivative Calculator",
                "description": "Calculates derivatives and shows step-by-step differentiation process",
                "mathExpression": "d/dx f(x)",
                "potentialAction": {
                    "@type": "SolveAction",
                    "target": "https://math.help/calculus/derivative-calculator/",
                    "object": {
                        "@type": "MathExpression",
                        "mathExpression": "f(x)"
                    }
                }
            }
        ]
    }
    </script>
    
    <meta name="google-adsense-account" content="ca-pub-5635114711353420">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5635114711353420" crossorigin="anonymous"></script>
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ERGV6WWC21"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ERGV6WWC21');
    </script>
    
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sgk1r5gd6a");
    </script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <h1 class="site-title">Math.help</h1>
            <p class="tagline">Master Mathematics Step by Step</p>
        </div>
    </header>
    
    <nav class="main-nav">
        <div class="container">
            <ul class="nav-list">
                <li><a href="/">Home</a></li>
                <li><a href="/algebra/">Algebra</a></li>
                <li><a href="/calculus/" class="active">Calculus</a></li>
                <li><a href="/geometry/">Geometry</a></li>
                <li><a href="/trigonometry/">Trigonometry</a></li>
                <li><a href="/statistics/">Statistics</a></li>
                <li><a href="/tools/">Calculators</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb">
        <div class="container">
            <ol class="breadcrumb-list">
                <li><a href="/">Home</a></li>
                <li><a href="/calculus/">Calculus</a></li>
                <li class="active">Derivative Calculator</li>
            </ol>
        </div>
    </nav>

    <main>
        <div class="container">
            <!-- Position 1: Top Ad -->
            <div class="ad-container ad-top">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-5635114711353420"
                     data-ad-slot="3137758017"
                     data-ad-format="horizontal"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

            <article class="main-content">
                <h1>Derivative Calculator</h1>
                
                <!-- Interactive Solver -->
                <section class="solver-section">
                    <div class="solver-box">
                        <h2>Calculate Derivative</h2>
                        <p>Enter a function to differentiate with respect to x</p>
                        <div class="function-input">
                            <input type="text" id="function-input" placeholder="e.g., x^2 + 3x + 5" value="x^2 + 3x + 5">
                            <button onclick="calculateDerivative()" class="solve-button">Find Derivative</button>
                        </div>
                        
                        <div class="quick-functions">
                            <p>Quick examples:</p>
                            <button onclick="setFunction('x^3 - 2x^2 + x')">Polynomial</button>
                            <button onclick="setFunction('sin(x) + cos(x)')">Trigonometric</button>
                            <button onclick="setFunction('e^x + ln(x)')">Exponential</button>
                            <button onclick="setFunction('x * sin(x)')">Product</button>
                        </div>
                        
                        <div id="solution-display" class="solution-display"></div>
                    </div>
                </section>

                <!-- Differentiation Rules -->
                <section class="rules-section">
                    <h2>Differentiation Rules</h2>
                    
                    <div class="rules-grid">
                        <div class="rule-box">
                            <h3>Power Rule</h3>
                            <p class="formula">$\frac{d}{dx}[x^n] = nx^{n-1}$</p>
                            <p class="example">$\frac{d}{dx}[x^3] = 3x^2$</p>
                        </div>
                        
                        <div class="rule-box">
                            <h3>Constant Rule</h3>
                            <p class="formula">$\frac{d}{dx}[c] = 0$</p>
                            <p class="example">$\frac{d}{dx}[5] = 0$</p>
                        </div>
                        
                        <div class="rule-box">
                            <h3>Sum Rule</h3>
                            <p class="formula">$\frac{d}{dx}[f + g] = f' + g'$</p>
                            <p class="example">$\frac{d}{dx}[x^2 + x] = 2x + 1$</p>
                        </div>
                        
                        <div class="rule-box">
                            <h3>Product Rule</h3>
                            <p class="formula">$\frac{d}{dx}[fg] = f'g + fg'$</p>
                            <p class="example">$\frac{d}{dx}[x \sin x] = \sin x + x\cos x$</p>
                        </div>
                        
                        <div class="rule-box">
                            <h3>Quotient Rule</h3>
                            <p class="formula">$\frac{d}{dx}[\frac{f}{g}] = \frac{f'g - fg'}{g^2}$</p>
                            <p class="example">$\frac{d}{dx}[\frac{x}{x+1}] = \frac{1}{(x+1)^2}$</p>
                        </div>
                        
                        <div class="rule-box">
                            <h3>Chain Rule</h3>
                            <p class="formula">$\frac{d}{dx}[f(g(x))] = f'(g(x)) \cdot g'(x)$</p>
                            <p class="example">$\frac{d}{dx}[\sin(2x)] = 2\cos(2x)$</p>
                        </div>
                    </div>
                </section>

                <!-- Position 2: Mid-content Ad -->
                <div class="ad-container in-content">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-5635114711353420"
                         data-ad-slot="4431777949"
                         data-ad-format="rectangle"
                         data-full-width-responsive="true"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Common Derivatives -->
                <section class="common-derivatives">
                    <h2>Common Derivatives</h2>
                    
                    <div class="derivatives-table">
                        <div class="table-section">
                            <h3>Trigonometric Functions</h3>
                            <table>
                                <tr><td>$\frac{d}{dx}[\sin x]$</td><td>$= \cos x$</td></tr>
                                <tr><td>$\frac{d}{dx}[\cos x]$</td><td>$= -\sin x$</td></tr>
                                <tr><td>$\frac{d}{dx}[\tan x]$</td><td>$= \sec^2 x$</td></tr>
                                <tr><td>$\frac{d}{dx}[\sec x]$</td><td>$= \sec x \tan x$</td></tr>
                                <tr><td>$\frac{d}{dx}[\csc x]$</td><td>$= -\csc x \cot x$</td></tr>
                                <tr><td>$\frac{d}{dx}[\cot x]$</td><td>$= -\csc^2 x$</td></tr>
                            </table>
                        </div>
                        
                        <div class="table-section">
                            <h3>Exponential & Logarithmic</h3>
                            <table>
                                <tr><td>$\frac{d}{dx}[e^x]$</td><td>$= e^x$</td></tr>
                                <tr><td>$\frac{d}{dx}[a^x]$</td><td>$= a^x \ln a$</td></tr>
                                <tr><td>$\frac{d}{dx}[\ln x]$</td><td>$= \frac{1}{x}$</td></tr>
                                <tr><td>$\frac{d}{dx}[\log_a x]$</td><td>$= \frac{1}{x \ln a}$</td></tr>
                            </table>
                        </div>
                        
                        <div class="table-section">
                            <h3>Inverse Trig Functions</h3>
                            <table>
                                <tr><td>$\frac{d}{dx}[\arcsin x]$</td><td>$= \frac{1}{\sqrt{1-x^2}}$</td></tr>
                                <tr><td>$\frac{d}{dx}[\arccos x]$</td><td>$= -\frac{1}{\sqrt{1-x^2}}$</td></tr>
                                <tr><td>$\frac{d}{dx}[\arctan x]$</td><td>$= \frac{1}{1+x^2}$</td></tr>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Examples -->
                <section class="examples-section">
                    <h2>Worked Examples</h2>
                    
                    <div class="example-box">
                        <h3>Example 1: Power Rule</h3>
                        <p>Find the derivative of $f(x) = 3x^4 - 2x^2 + 5x - 7$</p>
                        <div class="solution-steps">
                            <p>Apply the power rule to each term:</p>
                            <p>$f'(x) = \frac{d}{dx}[3x^4] - \frac{d}{dx}[2x^2] + \frac{d}{dx}[5x] - \frac{d}{dx}[7]$</p>
                            <p>$f'(x) = 3 \cdot 4x^3 - 2 \cdot 2x + 5 \cdot 1 - 0$</p>
                            <p>$f'(x) = 12x^3 - 4x + 5$</p>
                        </div>
                    </div>
                    
                    <div class="example-box">
                        <h3>Example 2: Product Rule</h3>
                        <p>Find the derivative of $f(x) = x^2 \sin x$</p>
                        <div class="solution-steps">
                            <p>Let $u = x^2$ and $v = \sin x$</p>
                            <p>Then $u' = 2x$ and $v' = \cos x$</p>
                            <p>Using product rule: $f'(x) = u'v + uv'$</p>
                            <p>$f'(x) = 2x \sin x + x^2 \cos x$</p>
                        </div>
                    </div>
                    
                    <div class="example-box">
                        <h3>Example 3: Chain Rule</h3>
                        <p>Find the derivative of $f(x) = (3x + 2)^5$</p>
                        <div class="solution-steps">
                            <p>Let $u = 3x + 2$, then $f(x) = u^5$</p>
                            <p>$\frac{df}{du} = 5u^4$ and $\frac{du}{dx} = 3$</p>
                            <p>By chain rule: $\frac{df}{dx} = \frac{df}{du} \cdot \frac{du}{dx}$</p>
                            <p>$f'(x) = 5(3x + 2)^4 \cdot 3 = 15(3x + 2)^4$</p>
                        </div>
                    </div>
                </section>

                <!-- Practice Problems -->
                <section class="practice-section">
                    <h2>Practice Problems</h2>
                    <ol class="practice-list">
                        <li>Find $\frac{d}{dx}[x^5 - 3x^3 + 2x]$</li>
                        <li>Find $\frac{d}{dx}[e^x \cos x]$</li>
                        <li>Find $\frac{d}{dx}[\frac{x^2}{x+1}]$</li>
                        <li>Find $\frac{d}{dx}[\ln(x^2 + 1)]$</li>
                        <li>Find $\frac{d}{dx}[\sin^2 x]$</li>
                        <li>Find $\frac{d}{dx}[\sqrt{x^2 + 4}]$</li>
                    </ol>
                    <details>
                        <summary>Show Answers</summary>
                        <ol>
                            <li>$5x^4 - 9x^2 + 2$</li>
                            <li>$e^x \cos x - e^x \sin x$</li>
                            <li>$\frac{x^2 + 2x}{(x+1)^2}$</li>
                            <li>$\frac{2x}{x^2 + 1}$</li>
                            <li>$2\sin x \cos x$</li>
                            <li>$\frac{x}{\sqrt{x^2 + 4}}$</li>
                        </ol>
                    </details>
                </section>

                <!-- Related Topics -->
                <section class="related-section">
                    <h2>Related Topics</h2>
                    <div class="related-links">
                        <a href="/calculus/limits/">Limits</a>
                        <a href="/calculus/integrals/">Integration</a>
                        <a href="/calculus/chain-rule/">Chain Rule</a>
                        <a href="/calculus/applications/">Applications of Derivatives</a>
                    </div>
                </section>

                <!-- Position 3: Bottom Ad -->
                <div class="ad-container ad-bottom">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-format="autorelaxed"
                         data-ad-client="ca-pub-5635114711353420"
                         data-ad-slot="2324489353"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
            </article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2024 Math.help. All rights reserved.</p>
            <div class="footer-links">
                <a href="/privacy.html">Privacy Policy</a>
                <a href="/terms.html">Terms of Service</a>
                <a href="/contact.html">Contact</a>
                <a href="/sitemap.xml">Sitemap</a>
            </div>
        </div>
    </footer>

    <style>
        /* Solver specific styles */
        .solver-box {
            background-color: var(--light-gray);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .function-input {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
        }
        
        #function-input {
            flex: 1;
            padding: 15px;
            font-size: 18px;
            border: 2px solid var(--border-color);
            border-radius: 5px;
        }
        
        .solve-button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        
        .solve-button:hover {
            background-color: #2980b9;
        }
        
        .quick-functions {
            margin: 15px 0;
        }
        
        .quick-functions button {
            margin: 5px;
            padding: 8px 15px;
            background-color: white;
            border: 2px solid var(--border-color);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quick-functions button:hover {
            background-color: var(--light-gray);
            border-color: var(--secondary-color);
        }
        
        .solution-display {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            display: none;
        }
        
        .solution-display.show {
            display: block;
        }
        
        .rules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .rule-box {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
            text-align: center;
        }
        
        .rule-box h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .rule-box .formula {
            background-color: #f0f8ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 1.1em;
        }
        
        .rule-box .example {
            color: #666;
            font-style: italic;
        }
        
        .derivatives-table {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 20px 0;
        }
        
        .table-section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }
        
        .table-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }
        
        .table-section table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table-section td {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .table-section td:first-child {
            text-align: right;
            padding-right: 15px;
        }
        
        .example-box {
            background-color: white;
            border-left: 4px solid var(--secondary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .solution-steps {
            margin-top: 15px;
            padding-left: 20px;
        }
        
        .solution-steps p {
            margin: 8px 0;
            line-height: 1.8;
        }
        
        .related-links {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .related-links a {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--light-gray);
            color: var(--primary-color);
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .related-links a:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .practice-list {
            background-color: var(--light-gray);
            padding: 20px 40px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .practice-list li {
            margin: 10px 0;
            font-size: 1.1em;
        }
        
        details {
            margin-top: 15px;
            padding: 15px;
            background-color: white;
            border-radius: 5px;
        }
        
        summary {
            cursor: pointer;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        @media (max-width: 768px) {
            .function-input {
                flex-direction: column;
            }
            
            #function-input {
                width: 100%;
            }
            
            .solve-button {
                width: 100%;
            }
        }
    </style>

    <script>
        function setFunction(func) {
            document.getElementById('function-input').value = func;
            calculateDerivative();
        }
        
        function parseFunction(input) {
            // Normalize input
            input = input.replace(/\s/g, '').toLowerCase();
            
            // Simple parsing for basic functions
            const terms = [];
            
            // Parse polynomial terms
            const polyRegex = /([+-]?\d*)x\^?(\d*)/g;
            let match;
            while ((match = polyRegex.exec(input)) !== null) {
                let coeff = match[1];
                let power = match[2];
                
                if (coeff === '' || coeff === '+') coeff = '1';
                else if (coeff === '-') coeff = '-1';
                
                if (power === '') power = '1';
                
                terms.push({
                    type: 'power',
                    coefficient: parseFloat(coeff),
                    power: parseFloat(power)
                });
            }
            
            // Parse constant term
            const constantMatch = input.match(/([+-]?\d+)(?!x)/);
            if (constantMatch && constantMatch[1]) {
                terms.push({
                    type: 'constant',
                    value: parseFloat(constantMatch[1])
                });
            }
            
            // Parse trig functions (simplified)
            if (input.includes('sin(x)')) {
                terms.push({ type: 'sin' });
            }
            if (input.includes('cos(x)')) {
                terms.push({ type: 'cos' });
            }
            if (input.includes('e^x')) {
                terms.push({ type: 'exp' });
            }
            if (input.includes('ln(x)')) {
                terms.push({ type: 'ln' });
            }
            
            return terms;
        }
        
        function derivativeToString(deriv) {
            let result = '';
            
            deriv.forEach((term, index) => {
                if (term.type === 'power') {
                    if (term.power === 0) {
                        // Constant term becomes 0
                        return;
                    }
                    
                    let coeff = term.coefficient * term.power;
                    let newPower = term.power - 1;
                    
                    if (index > 0 && coeff > 0) result += ' + ';
                    else if (coeff < 0) result += ' - ';
                    
                    let absCoeff = Math.abs(coeff);
                    if (absCoeff !== 1 || newPower === 0) {
                        result += absCoeff;
                    }
                    
                    if (newPower > 0) {
                        if (absCoeff === 1) result += 'x';
                        else result += 'x';
                        
                        if (newPower > 1) {
                            result += '^' + newPower;
                        }
                    }
                } else if (term.type === 'sin') {
                    if (index > 0) result += ' + ';
                    result += 'cos(x)';
                } else if (term.type === 'cos') {
                    result += ' - sin(x)';
                } else if (term.type === 'exp') {
                    if (index > 0) result += ' + ';
                    result += 'e^x';
                } else if (term.type === 'ln') {
                    if (index > 0) result += ' + ';
                    result += '1/x';
                }
            });
            
            return result || '0';
        }
        
        function calculateDerivative() {
            const input = document.getElementById('function-input').value;
            const display = document.getElementById('solution-display');
            
            try {
                const terms = parseFunction(input);
                
                let html = '<h3>Derivative Result:</h3>';
                html += `<p><strong>Original function:</strong> $f(x) = ${input}$</p>`;
                
                let derivative = [];
                let steps = '<p><strong>Steps:</strong></p><ol>';
                
                terms.forEach(term => {
                    if (term.type === 'power') {
                        if (term.power === 0) {
                            steps += `<li>Derivative of constant ${term.coefficient} is 0</li>`;
                        } else {
                            steps += `<li>For $${term.coefficient}x^{${term.power}}$: `;
                            steps += `Apply power rule → $${term.coefficient * term.power}x^{${term.power - 1}}$</li>`;
                            
                            derivative.push({
                                type: 'power',
                                coefficient: term.coefficient,
                                power: term.power
                            });
                        }
                    } else if (term.type === 'constant') {
                        steps += `<li>Derivative of constant ${term.value} is 0</li>`;
                    } else if (term.type === 'sin') {
                        steps += '<li>Derivative of $\\sin(x)$ is $\\cos(x)$</li>';
                        derivative.push({ type: 'sin' });
                    } else if (term.type === 'cos') {
                        steps += '<li>Derivative of $\\cos(x)$ is $-\\sin(x)$</li>';
                        derivative.push({ type: 'cos' });
                    } else if (term.type === 'exp') {
                        steps += '<li>Derivative of $e^x$ is $e^x$</li>';
                        derivative.push({ type: 'exp' });
                    } else if (term.type === 'ln') {
                        steps += '<li>Derivative of $\\ln(x)$ is $\\frac{1}{x}$</li>';
                        derivative.push({ type: 'ln' });
                    }
                });
                
                steps += '</ol>';
                
                const derivString = derivativeToString(derivative);
                
                html += steps;
                html += `<p><strong>Result:</strong> $f'(x) = ${derivString}$</p>`;
                
                display.innerHTML = html;
                display.classList.add('show');
                
                // Re-render math
                if (window.renderMathInElement) {
                    renderMathInElement(display);
                }
                
                // Track calculation
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'calculate_derivative', {
                        event_category: 'Calculator',
                        event_label: 'Derivative Calculator'
                    });
                }
                
            } catch (error) {
                display.innerHTML = `<p style="color: red;"><strong>Error:</strong> Could not parse function. Please enter a simpler function.</p>`;
                display.classList.add('show');
            }
        }
        
        // Calculate on Enter key
        document.getElementById('function-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateDerivative();
            }
        });
        
        // Calculate default function on load
        window.addEventListener('DOMContentLoaded', function() {
            calculateDerivative();
        });
    </script>
</body>
</html>